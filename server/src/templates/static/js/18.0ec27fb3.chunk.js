(this["webpackJsonppayference-fe"]=this["webpackJsonppayference-fe"]||[]).push([[18],{575:function(e,t,a){"use strict";var n=a(3),c=a(576),r=a(7),l=a(0),o=a.n(l),i=a(763),s={cursor:"grab"};t.a=function(e){var t=e.data,a=e.className,l=void 0===a?"":a,m=e.type,u=void 0===m?"ALL":m,d=e.children,p=Object(i.a)({item:{data:t,type:u},collect:function(e){return{isDropping:e.isDragging()}}}),f=Object(r.a)(p,2);Object(c.a)(f[0]);var b=f[1];return o.a.createElement("div",{ref:b,className:l,style:Object(n.a)({},s)},d)}},577:function(e,t,a){"use strict";var n=a(3),c=a(42),r=a(7),l=a(6),o=a(39),i=a(4),s=a.n(i),m=a(536),u=a.n(m),d=a(21),p=a.n(d),f=a(145),b=a(0),v=a.n(b),E=a(224),g=a(231),h=a(25),y=a(58),N=a(149);t.a=function(e){var t=e.onHide,a=e.show,i=e.invoices,m=e.getPaymentPlan,d=e.prevData,_=e.setEditPlan,D=i.reduce((function(e,t){return e+t.total_amount_due}),0),Y=i.length?s()(i,"[0].supplier.id",""):0,O=i.length?i.map((function(e){return e.id})):[],j=Object(b.useState)(!1),S=Object(r.a)(j,2),w=S[0],x=S[1],M=Object(b.useState)(""),C=Object(r.a)(M,2),P=C[0],k=C[1],F=Object(b.useState)(""),I=Object(r.a)(F,2),A=I[0],T=I[1],L=Object(b.useState)(""),U=Object(r.a)(L,2),B=U[0],R=U[1],H=Object(b.useState)(""),V=Object(r.a)(H,2),Q=V[0],q=V[1],z=Object(b.useState)([]),J=Object(r.a)(z,2),K=J[0],$=J[1],W=Object(b.useState)(!1),G=Object(r.a)(W,2),X=(G[0],G[1]),Z=Object(b.useState)(!1),ee=Object(r.a)(Z,2),te=ee[0],ae=ee[1],ne=Object(b.useState)(!1),ce=Object(r.a)(ne,2),re=ce[0],le=ce[1],oe=Object(b.useState)(D),ie=Object(r.a)(oe,2),se=ie[0],me=ie[1],ue=Object(b.useState)([]),de=Object(r.a)(ue,2),pe=de[0],fe=de[1],be=Object(b.useState)([]),ve=Object(r.a)(be,2),Ee=ve[0],ge=ve[1];Object(b.useEffect)((function(){var e=i.reduce((function(e,t){return e+t.total_amount_due}),0);me(e)}),[i.length]),Object(b.useEffect)((function(){if(d){x(!!d);for(var e=d.installments,t=e.map((function(e,t){return{no:t+1,id:e[0],date:p()(e[1]).format("YYYY-MM-DD"),amount:Number(Number(e[2]).toFixed(2)),isUpdated:!0}})),a=0,n=0;n<e.length;n++)a+=e[n][2];var c=i.map((function(e){return{id:e.id,name:e.invoice_number,isSelected:d.invoices.includes(e.id),totalAmount:e.total_amount_due}}));fe(c),me(a),T(e.length),$(t)}}),[d]);var he=function(e){var t=Object(c.a)(K).filter((function(t){return t.no!==e})),a=t.filter((function(e){return e.isUpdated})).reduce((function(e,t){return e+Number(t.amount)}),0),r=t.filter((function(e){return!e.isUpdated})).length,l=t.map((function(e,t){return Object(n.a)({},e,{no:t+1})})).map((function(e){return Object(n.a)({},e,{amount:e.isUpdated?e.amount:Number(Number((se-a)/r).toFixed(2))})}));T(A-1),$(l),X(!1)},ye=function(e,t){if(!(t>se)){var a=t?Number(Number(t).toFixed(2)):"",c=K.filter((function(t){return t.no===e||t.isUpdated})).reduce((function(t,n){return t+(n.no===e?a:Number(n.amount))}),0),r=K.filter((function(t){return!t.isUpdated&&t.no!==e})).length,l=K.map((function(a){return a.no===e?Object(n.a)({},a,{amount:t||"",isUpdated:!0}):a.isUpdated?a:Object(n.a)({},a,{amount:Number(Number((se-(c||0))/r).toFixed(2))})}));$(l)}},Ne=function(){(se-K.reduce((function(e,t){return e+Number(t.amount)}),0)).toFixed(2)>0&&Oe()},_e=function(e,t){var a=K.map((function(a){return a.no===e?Object(n.a)({},a,{date:t}):a}));$(a)},De=function(){var e=K.reduce((function(e,t){return e+Number(t.amount)}),0);console.log("totalPlanAmount: ",e),Math.round(e)!==Math.round(se)?ae(!0):d?(ae(!1),xe()):(ae(!1),we())},Ye=function(){var e=K.filter((function(e){return e.isUpdated})).reduce((function(e,t){return e+Number(t.amount)}),0),t=K.filter((function(e){return!e.isUpdated})).length+1,a=K.map((function(e,t){return Object(n.a)({},e,{no:t+1})})).concat({no:K.length+1,amount:Number((se-e)/t).toFixed(2),date:p()(K[A-1].date).add(Q,"days").format("YYYY-MM-DD")}).map((function(a){return Object(n.a)({},a,{amount:a.isUpdated?a.amount:Number(Number((se-e)/t).toFixed(2))})})),c=(se-a.reduce((function(e,t){return e+Number(t.amount)}),0)).toFixed(2);0!==c&&s()(a,"[".concat(a.length-1,"].amount"),0)&&(a[a.length-1].amount=a[a.length-1].amount+Number(c)),T(A+1),$(a)},Oe=function(){for(var e=d.installments,t=0;t<e.length;t++)e[t][2];var a=0;A>=2&&(a=Object(f.a)({startdate:p()(K[A-2].date),enddate:p()(K[A-1].date)}));var n=K.concat({no:K.length+1,amount:Number(se-K.reduce((function(e,t){return e+Number(t.amount)}),0)).toFixed(2),date:p()(K[A-1].date,"YYYY-MM-DD").add(a,"days").format("YYYY-MM-DD")});T(A+1),$(n)};Object(b.useEffect)((function(){var e=document.querySelectorAll("input[type=number]");if(e.length)for(var t=["-","+","e"],a=0;a<e.length;a++)e[a].addEventListener("input",(function(){this.value=this.value.replace(/[e\+\-]/gi,"")})),e[a].addEventListener("keydown",(function(e){t.includes(e.key)&&e.preventDefault()}))}));var je=function(){var e=0!=(se-K.reduce((function(e,t){return e+Number(t.amount)}),0)).toFixed(2),t=100===K.length;return v.a.createElement(v.a.Fragment,null,te?v.a.createElement("div",{className:"row pb-3"},v.a.createElement("div",{className:"col-sm-12 text-warning"},"Your updated plan amount is not matching actual amount, Please update your plan amount and save."),v.a.createElement("div",{className:"col-sm-6"})):null,v.a.createElement("div",{className:"row pb-3"},v.a.createElement("div",{className:"col-sm-6"},v.a.createElement("strong",null,"Actual Amount: ")," ",se.toFixed(2)," ",v.a.createElement("br",null),v.a.createElement("strong",null,"Updated Amount: ")," ",K.reduce((function(e,t){return e+Number(t.amount)}),0).toFixed(2),v.a.createElement("br",null),v.a.createElement("strong",null,"Difference: "),(se-K.reduce((function(e,t){return e+Number(t.amount)}),0)).toFixed(2))),v.a.createElement("div",{className:"row mb-2"},v.a.createElement("div",{className:"col-sm-6"},v.a.createElement("strong",null,"Invoices: "),v.a.createElement("span",null,pe.filter((function(e){return e.isSelected})).map((function(e,t){return v.a.createElement("span",null,v.a.createElement(h.b,{to:"/payables/".concat(e.id),target:"_blank"},e.name),pe.filter((function(e){return e.isSelected})).length!==t+1&&","," ")})))),v.a.createElement("div",{className:"col-sm-6"},v.a.createElement("div",{className:"dropdown",style:{padding:5}},v.a.createElement("span",{className:"dropdown-toggle all-account cursour-pointer",onClick:function(){return le(!0)}},"Select Invoices"),v.a.createElement(o.a,{onClickAway:le},v.a.createElement("div",{className:"cursour-pointer dropdown-menu hide-scroll ".concat(re?"show":""),style:{maxHeight:"50vh",overflowY:"scroll"},"aria-labelledby":"dropdownMenuLink",id:"companylist"},pe.map((function(e){return v.a.createElement("label",{className:"d-block cursor-pointer",key:"".concat(e.id,"-").concat(e.isSelected),style:{background:e.isSelected?"#eee":void 0},onClick:function(){var t=pe.map((function(t){return t.id===e.id?(me(t.isSelected?se-t.totalAmount:se+t.totalAmount),Object(n.a)({},t,{isSelected:!t.isSelected})):t}));fe(t)}},v.a.createElement("input",{type:"checkbox",className:"mr-2",name:e.name,defaultChecked:e.isSelected}),e.name)}))))))),v.a.createElement("div",{className:"row mb-1 pb-2 border-bottom"},v.a.createElement("div",{className:"col-sm-2 d-flex align-items-center"},v.a.createElement("strong",null,"No")),v.a.createElement("div",{className:"col-sm-5 d-flex align-items-center"},v.a.createElement("strong",null,"Date")),v.a.createElement("div",{className:"col-sm-4"},v.a.createElement("strong",null,"Amount")),v.a.createElement("div",{className:"col-sm-1"})),v.a.createElement("div",{style:{"max-height":"38vh",overflowY:"scroll"}},K.map((function(e,t){return v.a.createElement("div",{className:"row mb-2  pb-2 border-bottom",key:e.no},v.a.createElement("div",{className:"col-sm-1 d-flex align-items-center"},e.no),v.a.createElement("div",{className:"col-sm-5 single-date-picker"},v.a.createElement(N.a,{labelFormat:"MMM DD, YYYY",startDate:e.date?p()(new Date(e.date)):void 0,getSelectedDates:function(t){return _e(e.no,t.format("YYYY-MM-DD"))}})),v.a.createElement("div",{className:"col-sm-4"},v.a.createElement("input",{className:"form-control",disabled:1===K.length,value:e.amount,min:"0",max:Number(se)+1,onFocus:function(){X(e.no)},onInput:function(t){ye(e.no,t.target.value)},onBlur:Ne,type:"number"})),A>=2&&v.a.createElement("div",{className:"col-sm-2 d-flex align-items-center"},v.a.createElement("i",{className:"fa fa-remove cursor-pointer",onClick:function(){return function(e){e.id?(ge([].concat(Object(c.a)(Ee),[e.id])),he(e.no)):he(e.no)}(e)}})))}))),v.a.createElement("hr",null),v.a.createElement("div",{className:"mt-4"},v.a.createElement(E.a,{disabled:t,onClick:Oe,className:"mr-2"},"Add New"),v.a.createElement(E.a,{disabled:e,onClick:De},"Update Plan")))},Se=function(){x(!1),k(""),q(""),T(""),X(!1),ae(!1),_&&_(null)},we=function(){var a={supplier_id:Y,invoices:O,installments:K.map((function(e){return{date:p()(e.date).format("MM/DD/YYYY"),amount:Number(e.amount).toFixed(2)}})),is_payment_plan:!0};l.a.post("paymentplan",Object(n.a)({},a)).then((function(a){m(!0),t(),Se(),e.setactiveKey&&e.setactiveKey("paymentPlan"),localStorage.setItem("refresh_reports",!0)}))},xe=function(){var e=pe.filter((function(e){return e.isSelected})).map((function(e){return e.id})),a=e.filter((function(e){return!d.invoices.includes(e)})),c=d.invoices.filter((function(t){return-1===e.indexOf(t)})),r={installments:{add:K.filter((function(e){return e&&!e.id})).map((function(e){return{amount:Number(e.amount).toFixed(2),date:p()(e.date).format("MM/DD/YYYY")}})),edit:K.filter((function(e){return e&&e.id})).map((function(e){return{id:e.id,amount:Number(e.amount).toFixed(2),date:p()(e.date).format("MM/DD/YYYY")}})),delete:Ee},invoices:{add:a,delete:c},is_payment_plan:!0};l.a.patch("paymentplan?id=".concat(d.id),Object(n.a)({},r)).then((function(e){m(!0),t(),Se(),localStorage.setItem("refresh_reports",!0)}))};return v.a.createElement(g.a,{size:"lg",backdrop:"static",show:a,onHide:function(){t(),Se()},className:"mt-4"},v.a.createElement(g.a.Header,{closeButton:!0},v.a.createElement("strong",null,s()(d,"id","")?"Update Payment Plan":"Add Payment Plan")),v.a.createElement(g.a.Body,{style:{"max-height":"calc(100vh - 210px)","overflow-y":"auto"}},w?function(){if(w){if(w&&d)return je();var e=0!=(se-K.reduce((function(e,t){return e+Number(t.amount)}),0)).toFixed(2),t=100===K.length;return v.a.createElement("div",null,v.a.createElement("div",{className:"row mb-1"},v.a.createElement("div",{className:"col-sm-4 d-flex align-items-center mb-2"},v.a.createElement("strong",null,"Total Amount:"),v.a.createElement("span",{className:"ml-3"},Object(y.d)(se.toFixed(2))))),v.a.createElement("div",{className:"row mb-2"},v.a.createElement("div",{className:"col-sm-4 d-flex align-items-center mb-2"},v.a.createElement("strong",null,"Difference:"),v.a.createElement("span",{className:"ml-3"},(se-K.reduce((function(e,t){return e+Number(t.amount)}),0)).toFixed(2)))),te?v.a.createElement("div",{className:"row pb-3"},v.a.createElement("div",{className:"col-sm-12"},"Your updated plan amount is not matching actual amount, Please update your plan amount and save."),v.a.createElement("div",{className:"col-sm-6"},v.a.createElement("strong",null,"Actual Amount:")," ",se.toFixed(2)," ",v.a.createElement("br",null),v.a.createElement("strong",null,"Updated Amount:")," ",K.reduce((function(e,t){return e+Number(t.amount)}),0).toFixed(2),v.a.createElement("br",null)),v.a.createElement("div",{className:"col-sm-6"})):null,v.a.createElement("div",{className:"row mb-1 pb-2 border-bottom"},v.a.createElement("div",{className:"col-sm-2 d-flex align-items-center"},v.a.createElement("strong",null,"No")),v.a.createElement("div",{className:"col-sm-5 d-flex align-items-center"},v.a.createElement("strong",null,"Date")),v.a.createElement("div",{className:"col-sm-4"},v.a.createElement("strong",null,"Amount")),v.a.createElement("div",{className:"col-sm-1"})),v.a.createElement("div",{style:{"max-height":"38vh",overflowY:"scroll"}},K.map((function(e,t){return v.a.createElement("div",{className:"row mb-2  pb-2 border-bottom",key:e.no},v.a.createElement("div",{className:"col-sm-1 d-flex align-items-center"},e.no),v.a.createElement("div",{className:"col-sm-5 single-date-picker"},v.a.createElement(N.a,{labelFormat:"MMM DD, YYYY",startDate:e.date?p()(new Date(e.date)):void 0,getSelectedDates:function(t){return _e(e.no,t.format("YYYY-MM-DD"))}})),v.a.createElement("div",{className:"col-sm-4"},v.a.createElement("input",{className:"form-control",disabled:1===K.length,defaultValue:e.amount,value:e.amount||void 0,min:"0",max:Number(se)+1,onFocus:function(){X(e.no)},onInput:function(t){ye(e.no,t.target.value)},type:"number"})),A>=2&&v.a.createElement("div",{className:"col-sm-2 d-flex align-items-center"},v.a.createElement("i",{className:"fa fa-remove cursor-pointer",onClick:function(){return K.length>1?he(e.no):{}}})))}))),v.a.createElement("div",{className:"mt-3"},v.a.createElement(E.a,{disabled:t,onClick:Ye,className:"mr-2"},"Add New"),v.a.createElement(E.a,{disabled:e,onClick:De},"Save Plan")))}}():v.a.createElement(v.a.Fragment,null,v.a.createElement("div",{className:"row mb-2"},v.a.createElement("div",{className:"col-sm-4 d-flex align-items-center"},v.a.createElement("strong",null,"Invoices:")),v.a.createElement("div",{className:"col-sm-8"},i.map((function(e,t){return v.a.createElement("span",null,v.a.createElement(h.b,{to:"/payables/".concat(e.id),target:"_blank"},e.invoice_number),t!==i.length-1&&","," ")})))),v.a.createElement("div",{className:"row mb-2"},v.a.createElement("div",{className:"col-sm-4 d-flex align-items-center"},v.a.createElement("strong",null,"Total Amount:")),v.a.createElement("div",{className:"col-sm-8"},Object(y.d)(se.toFixed(2)))),v.a.createElement("div",{className:"row mb-2"},v.a.createElement("div",{className:"col-sm-4  d-flex align-items-center"},v.a.createElement("strong",null,"Start on:")),v.a.createElement("div",{className:"col-sm-8 single-date-picker"},v.a.createElement(N.a,{disabled:w,labelFormat:"MMM DD, YYYY",getSelectedDates:function(e){return k(e.format("YYYY-MM-DD"))}}))),v.a.createElement("div",{className:"row mb-2"},v.a.createElement("div",{className:"col-sm-4  d-flex align-items-center"},v.a.createElement("strong",null,"Installment amount:")),v.a.createElement("div",{className:"col-sm-8"},v.a.createElement("input",{type:"number",min:"1",max:Number(se)+1,className:"form-control",disabled:w,onInput:function(e){return R(Number(e.target.value))}}))),v.a.createElement("div",{className:"row mb-4"},v.a.createElement("div",{className:"col-sm-4  d-flex align-items-center"},v.a.createElement("strong",null,"Days between installments:")),v.a.createElement("div",{className:"col-sm-8"},v.a.createElement("input",{min:"1",max:"365",className:"form-control",disabled:w,onInput:function(e){return q(Number(e.target.value))},type:"number"}))),v.a.createElement("div",null,v.a.createElement(E.a,{disabled:!B||!Q||!P,onClick:function(){return function(){var e=se%B,t=Math.floor(se/B);t=e?t+1:t;var a=u()(0,t).map((function(a,n){return{no:n+1,date:p()(P).add(a*Q,"days").format("YYYY-MM-DD"),amount:Number(n===t-1?e:B).toFixed(2),isUpdated:!1}}));T(t),$(a),x(!0)}()}},w?"Regenerate Plan":"Generate Plan")))))}},777:function(e,t,a){"use strict";a.r(t);var n=a(7),c=a(0),r=a.n(c),l=a(12),o=a(66),i=(a(150),a(42)),s=a(3),m=a(14),u=a(15),d=a(17),p=a(16),f=a(43),b=a(18),v=a(9),E=a(69),g=a(39),h=a(504),y=a(159),N=a(618),_=a(508),D=a(619),Y=a(575),O=a(13),j=a(93),S=a(10),w=a(95),x=a.n(w),M=a(4),C=a.n(M),P=a(68),k=a.n(P),F=a(30),I=a(21),A=a.n(I),T=a(94),L=a(74),U=a(11),B=a(58),R=a(145),H=a(73),V=a(6),Q=[{id:0,type:"Total Amount",amount:"$0",isFetching:!1},{id:1,type:"Critical",amount:"$0",isFetching:!1},{id:2,type:"High",amount:"$0",isFetching:!1},{id:3,type:"Medium",amount:"$0",isFetching:!1},{id:4,type:"Low",amount:"$0",isFetching:!1}],q={Today:1,"Next 7 Days":7,"Next 30 Days":30,"Past 7 Days":7,"Past 30 Days":30};function z(e,t){var a;return e.length?e.map((function(e){var a;return a={Supplier:C()(e,"supplier.name",""),InvoiceNo:C()(e,"invoice_number","")},Object(v.a)(a,"open"===t?"Due date":"all"===t?"Due/Closed Date":"Closed Date",C()(e,"".concat("open"===t?"due_date":"date_closed"),"")?A()(C()(e,"".concat("open"===t?"due_date":"date_closed"),"")).format("MM/DD/YYYY"):C()(e,"due_date","")?A()(C()(e,"due_date","")).format("MM/DD/YYYY"):A()(C()(e,"date_closed","")).format("MM/DD/YYYY")),Object(v.a)(a,"Recommendation","PAY_IMMEDIATELY"===C()(e.insights)?"PAY NOW":C()(e,"recommendation","")?Object(R.b)(C()(e,"recommendation","")):"-"),Object(v.a)(a,"InvoiceDate",A()(C()(e,"invoice_date","")).format("MM/DD/YYYY")),Object(v.a)(a,"AmountDue",Object(B.b)(C()(e,"total_amount_due",0))),a})):[(a={Supplier:"",InvoiceNo:""},Object(v.a)(a,"open"===t?"Due date":"all"===t?"Due/Closed Date":"Closed Date",""),Object(v.a)(a,"InvoiceDate",""),Object(v.a)(a,"AmountDue",""),a)]}var J={0:"default",1:"criticalclr",2:"highclr",3:"mediumclr",4:"lowclr"},K=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(d.a)(this,Object(p.a)(t).call(this))).setshowExport=function(t){e.setState({showexport:t})},e.exportAllData=function(t){var a=e.state,n=a.startDate,c=a.endDate,r=a.sentiment,l=a.status,o=a.dateType,i=a.vendorSelect,s=a.invoiceSelect,m=a.category,u=a.amount_greater_than,d=a.amount_less_than,p="apinvoice?per_page=2000";n&&c&&(p+="&from_date='".concat(n,"'&to_date='").concat(c,"'")),r&&(p+="&sentiment=".concat(r)),u&&(p+="&amount_greater_than=".concat(u)),d&&(p+="&amount_less_than=".concat(d)),l&&(p+="&status='".concat(l,"'")),o&&(p+="&date_type='".concat(o,"'")),i&&(p+="&supplier_id=".concat(i.id)),s&&(p+="&invoice_id=".concat(s.name)),m&&(p+="&category=".concat(m)),V.c.get(p).then((function(a){e.setState({exportedData:a.data.result,showexport:!1},(function(){!0===t?e.refs.csv.link.click():function(e){var t="Payables ".concat(A()().format("MMMM Do YYYY-h:mm:ss-a"),".xlsx"),a={Sheets:{data:H.utils.json_to_sheet(e)},SheetNames:["data"]},n=H.write(a,{bookType:"xlsx",type:"array"}),c=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});j.saveAs(c,t)}(z(a.data.result,l))}))})).catch((function(e){return Object(S.a)(e)}))},e.onChangeClassification=function(t){e.setState({category:t||"",currPage:1},(function(){e.filters=Object(s.a)({},e.filters,{category:t||""}),localStorage.setItem("payableFilters",JSON.stringify(e.filters)),e.filterData()}))},e.updateBoxes=function(t,a){var n=e.state.rankBoxes.map((function(e){return e.id===t?Object(s.a)({},e,{amount:a}):e}));e.setState({rankBoxes:n})},e.getClassificationData=function(t){var a=e.state,n=a.endDate,c=a.startDate,r=a.dateType,l=a.status,o="apinvoice/total?".concat(t||"&from_date='".concat(c,"'&to_date='").concat(n,"'&status='").concat(l,"'&date_type='").concat(r,"'"));V.c.get(o).then((function(t){e.updateBoxes(0,Object(B.a)(t.data.total))})).catch((function(e){return Object(S.a)(e)})),V.c.get("".concat(o,"&category=1")).then((function(t){e.updateBoxes(1,Object(B.a)(t.data.total))})).catch((function(e){return Object(S.a)(e)})),V.c.get("".concat(o,"&category=2")).then((function(t){e.updateBoxes(2,Object(B.a)(t.data.total))})).catch((function(e){return Object(S.a)(e)})),V.c.get("".concat(o,"&category=3")).then((function(t){e.updateBoxes(3,Object(B.a)(t.data.total))})).catch((function(e){return Object(S.a)(e)})),V.c.get("".concat(o,"&category=4")).then((function(t){e.updateBoxes(4,Object(B.a)(t.data.total))})).catch((function(e){return Object(S.a)(e)}))},e.setNextPage=function(){e.setState({currPage:e.state.currPage+1},e.filterData)},e.setPrevPage=function(){e.setState({currPage:1===e.state.currPage?1:e.state.currPage-1},e.filterData)},e.getVendorCategory=function(){V.c.get("vendorcategory?per_page=1000").then((function(t){e.setState({vendorCategoryList:t.data.result})})).catch((function(e){return Object(S.a)(e)}))},e.searchVendor=function(t,a){var n,c="apinvoice/search?per_page=100&".concat(a,"=").concat(t);t?(e.setState((n={},Object(v.a)(n,"is".concat(a,"Fetching"),!0),Object(v.a)(n,"supplierList",[]),Object(v.a)(n,"vendorSelect","vendor"===a?null:e.state.vendorSelect),Object(v.a)(n,"invoiceSelect","invoice"===a?null:e.state.invoiceSelect),n)),V.c.get(c).then((function(t){e.setState(Object(v.a)({supplierList:t.data.result},"is".concat(a,"Fetching"),!1))})).catch((function(e){return Object(S.a)(e)}))):e.setState(Object(v.a)({supplierList:[]},"".concat(a,"Select"),null))},e.filterData=function(){e.setState({showFilter:!1});var t=e.state,a=t.startDate,n=t.endDate,c=t.sentiment,r=t.status,l=t.dateType,o=t.vendorSelect,i=t.invoiceSelect,s=t.currPage,m=t.amount_greater_than,u=t.amount_less_than,d=t.category,p=t.api_sort_by,f=t.api_sort_order,b=t.vendor_category_id,v=t.payment_plan,E="",g={currPage:s};i?(g.invoiceSelect=i,E+="&invoice_id=".concat(i.name),E+="&status=all"):(o?(g.vendorSelect=o,E+="&supplier_id=".concat(o.id)):a&&n&&(g.startDate=a,g.endDate=n,E+="&from_date='".concat(a,"'&to_date='").concat(n,"'")),v&&(g.payment_plan=v,E+="&payment_plan=".concat(v)),c&&(g.sentiment=c,E+="&sentiment=".concat(c)),m&&(g.amount_greater_than=m,E+="&amount_greater_than=".concat(m)),u&&(g.amount_less_than=u,E+="&amount_less_than=".concat(u)),r&&(g.status=r,E+="&status='".concat(r,"'")),l&&(g.dateType=l,E+="&date_type='".concat(l,"'")),d&&(g.category=d),p&&(g.api_sort_by=p,g.api_sort_order=f,E+="&sort_by=".concat(p,"&sort_order=").concat(f)),b&&(g.vendor_category_id=b,E+="&vendor_category_id=".concat(b))),localStorage.setItem("payableFilters",JSON.stringify(g)),e.getData(E),e.getClassificationData(E)},e.getData=function(t){var a=e.state,n=a.endDate,c=a.startDate,r=a.currPage,l=a.dateType,o=a.status,i=a.category,m=a.selectedInvoices,u=void 0===m?[]:m,d="apinvoice?page=".concat(r).concat(0!=i&&i?"&category=".concat(i):"").concat(t||"&from_date='".concat(c,"'&to_date='").concat(n,"'&status='").concat(o,"'&date_type='").concat(l,"'"));e.setState({isFetching:!0}),V.c.get(d).then((function(t){e.setState({isFetching:!1,isFetchingOriginal:!1});var a=C()(t,"data.result",[]).map((function(e){return Object(s.a)({},e,{isselected:u.filter((function(t){return t===e.id})).length>0})}));e.setState({rows:a,originalRows:a,showFilter:!1})})).catch((function(t){e.setState({isFetching:!1,showFilter:!1}),Object(S.a)(t)}))},e.setshowFilter=function(t){e.setState({showFilter:t})},e.onReset=function(){document.getElementById("filter-form").reset(),e.setState({endDate:A()().add(30,"days").format("MM/DD/YYYY"),startDate:A()().format("MM/DD/YYYY"),category:0,sentiment:"",status:"open",selectedSupplier:"",dateType:"due",vendorSelect:null,currPage:1,supplierList:[],invoiceSelect:null,amount_greater_than:"",amount_less_than:"",api_sort_by:"",api_sort_order:"asc",vendor_category_id:""},(function(){localStorage.removeItem("payableFilters"),e.getData(),e.getClassificationData()}))},e.onDrop=function(t,a){var n="vendor"===t.data.type?"supplier":"apinvoice";V.c.put("".concat(n,"?id=").concat(t.data.id),{classification:a.id}).then((function(){setTimeout((function(){e.filterData()}),500)})).catch((function(e){return Object(S.a)(e)}))},e.getRating=function(t,a){V.c.put("supplier?id=".concat(t),{sentiment:a}).catch((function(e){return Object(S.a)(e)}));var n=e.state.rows.map((function(e){return e.supplier.id===t?Object(s.a)({},e,{client_supplier_rel:Object(s.a)({},e.client_supplier_rel,{sentiment:a})}):e}));e.setState({rows:n})},e.setDates=function(t,a,n){e.setState({startDate:A()(t).format("MM/DD/YYYY"),endDate:A()(a).format("MM/DD/YYYY"),interval:q[n||30],showFilter:!0})},e.setAPISort=function(t){var a={currPage:1};"status"===t&&(a.status="all"),e.setState(Object(s.a)({},a,{api_sort_by:t,api_sort_order:t===e.state.api_sort_by&&"asc"===e.state.api_sort_order?"desc":"asc"}),e.filterData)},e.fastForwardPayiq=function(t){var a=e.state.rows,n=a.filter((function(e){return e.isselected})),c=n.map((function(e){return V.c.put("/apinvoice?id=".concat(e.id),{recommendation_date:A()().add(1,t).format("MM/DD/YYYY")})}));Promise.all(c).then((function(){Object(O.a)("Updated successfully","success"),e.setState({dateModalType:"",showDateModal:!1,rows:a.map((function(e){return Object(s.a)({},e,{recommendation:e.isselected?A()().add(1,t).format("MM/DD/YYYY"):e.recommendation,reco_date_overridden:!1,isselected:!1})}))},(function(){localStorage.setItem("refresh_reports",!0),e.filterData()}));var c=n.map((function(e){return V.c.put("/supplier/note",{date:A()().format("MM/DD/YYYY"),note:"".concat(e.invoice_number,": Updated PayIQ"),invoice_id:e.id,supplier_id:C()(e,"supplier.id","")})}));Promise.all(c)}))},e.deletePayIq=function(){Object(F.c)({variant:"warning",msg:"Are you sure you want to delete this record?",onSave:function(){Object(F.b)();var t=e.state.rows,a=t.filter((function(e){return e.isselected}));V.c.delete("apinvoice",{data:{ids:a.map((function(e){return e.id}))}}).then((function(){e.setState({rows:t.map((function(e){return Object(s.a)({},e,{isselected:!1})}))},(function(){localStorage.setItem("refresh_reports",!0),e.filterData()}))})).catch((function(){Object(O.a)("invoices cannot be deleted","error")}))}})},e.debounceMethod=x()(e.searchVendor.bind(Object(f.a)(e)),200),e.state={rows:[],originalRows:[],showFilter:!1,showexport:!1,currPage:1,isFetchingOriginal:!0,isFetching:!0,isvendorFetching:!1,isinvoiceFetching:!1,supplierList:[],endDate:A()().add(30,"days").format("MM/DD/YYYY"),startDate:A()().format("MM/DD/YYYY"),interval:30,vendorCategory:"",sentiment:"",status:"open",selectedSupplier:"",rankBoxes:Q,dateType:"due",vendorSelect:null,invoiceSelect:null,category:0,exportedData:[],amount_greater_than:"",amount_less_than:"",api_sort_by:"",api_sort_order:"asc",vendorCategoryList:[],vendor_category_id:""},e.filters=JSON.parse(localStorage.getItem("payableFilters")),e}return Object(b.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.filters=JSON.parse(localStorage.getItem("payableFilters")),JSON.parse(localStorage.getItem("payableFilters"))?this.setState(Object(s.a)({},this.filters),(function(){e.filterData()})):(this.getData(),this.getClassificationData()),this.getVendorCategory(),window.scrollTo(0,0),window.addEventListener("scroll",(function(){var e=window.pageYOffset;document.querySelector(".payablenewfiltercnt")&&(e>100?document.querySelector(".payablenewfiltercnt").classList.add("sticky"):document.querySelector(".payablenewfiltercnt").classList.contains("sticky")&&document.querySelector(".payablenewfiltercnt").classList.remove("sticky"))}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",(function(){}));var e=this.state.rows,t=void 0===e?[]:e;if(C()(window,"location.pathname","").includes("payables")){var a=this.filters||{};a.selectedInvoices=t.filter((function(e){return e.isselected})).map((function(e){return e.id})),localStorage.setItem("payableFilters",JSON.stringify(a))}}},{key:"render",value:function(){var e=this,t=this.state,a=t.dateType,n=t.sentiment,c=t.status,l=t.rows,o=t.showFilter,m=t.showexport,u=t.currPage,d=t.isFetching,p=t.startDate,f=t.endDate,b=t.rankBoxes,j=t.vendorSelect,S=t.invoiceSelect,w=t.isvendorFetching,x=t.isinvoiceFetching,M=t.supplierList,P=t.exportedData,F=t.amount_greater_than,I=t.amount_less_than,H=t.vendor_category_id,Q=t.vendorCategoryList,q=t.dateModalType,K=t.showDateModal,$=t.overridden,W=void 0===$||$,G=l&&l.find((function(e){return e.isselected})),X=C()(l,"[0]","")&&!l.find((function(e){return!e.isselected})),Z={Invoice:"expected_invoice_date",PayIQ:"recommendation_date",Due:"expected_due_date"},ee=[{Header:r.a.createElement("input",{className:"md-checkbox",onClick:function(){var t=!X;e.setState({rows:Object(i.a)(l.map((function(e){return Object(s.a)({},e,{isselected:t})})))})},type:"checkbox",checked:!!X}),accessor:"isselected",Cell:function(t){return r.a.createElement("div",null,r.a.createElement("input",{onClick:function(a){a.stopPropagation();var n=!t.value,c=Object(i.a)(l);c[t.index].isselected=n,e.setState({rows:c})},className:"md-checkbox",style:{marginLeft:15},type:"checkbox",checked:!!t.value}))},sortable:!1,filterable:!1,width:50},{Header:function(){return r.a.createElement("div",{className:"cursour-pointer ml-4",onClick:function(){e.setAPISort("invoice_number")}},"Invoice",r.a.createElement("span",{className:"sort-icons"},r.a.createElement("i",{className:"fas fa-caret-up"}),r.a.createElement("i",{className:"fas fa-caret-down"})))},width:200,accessor:"invoice_number",Cell:function(e){var t=C()(e,"original.classification","")||C()(e,"original.client_supplier_rel.classification","")||C()(e,"original.supplier.classification","")||4;return r.a.createElement(Y.a,{data:{id:C()(e,"original.id",""),type:"invoice"},key:C()(e,"original.invoice_number","lowclr")},r.a.createElement("span",{className:"ml-2 mr-2 ".concat(J[t||0])})," ",r.a.createElement("span",null,C()(e,"original.invoice_number","")))}},{Header:function(){return r.a.createElement("span",null,"Vendor",r.a.createElement("span",{className:"sort-icons"},r.a.createElement("i",{className:"fas fa-caret-up"}),r.a.createElement("i",{className:"fas fa-caret-down"})))},width:250,accessor:"supplier.name",Cell:function(e){return r.a.createElement(Y.a,{data:{id:C()(e,"original.supplier.id",""),type:"vendor"}},r.a.createElement("span",null,C()(e,"original.supplier.name","")))}},{Header:function(){return r.a.createElement("span",null,"PayIQ date",r.a.createElement("span",{className:"sort-icons"},r.a.createElement("i",{className:"fas fa-caret-up"}),r.a.createElement("i",{className:"fas fa-caret-down"})))},accessor:"insights",Cell:function(e){return r.a.createElement("div",null,"PAY_IMMEDIATELY"!==e.original.insights||C()(e,"original.reco_date_overridden","")?C()(e,"original.recommendation","")?Object(R.b)(C()(e,"original.recommendation","")):"-":"PAY NOW",C()(e,"original.reco_date_overridden","")&&W?r.a.createElement("i",{className:"fa fa-check text-success m-1"}):"")}},{Header:function(){return r.a.createElement("span",{className:"cursour-pointer",onClick:function(){e.setAPISort("open"===c||"all"===c?"due_date":"date_closed")}},"open"===c?"Due date":"all"===c?"Due/Closed Date":"Closed Date",r.a.createElement("span",{className:"sort-icons"},r.a.createElement("i",{className:"fas fa-caret-up"}),r.a.createElement("i",{className:"fas fa-caret-down"})))},accessor:"open"===c||"all"===c?"due_date":"date_closed",Cell:function(e){return"all"===c?C()(e,"original.due_date","")?Object(R.b)(C()(e,"original.due_date","")):Object(R.b)(C()(e,"original.date_closed","")):"open"===c?Object(R.b)(C()(e,"original.due_date","")):Object(R.b)(C()(e,"original.date_closed",""))}},{Header:function(){return r.a.createElement("span",{className:"cursour-pointer",onClick:function(){var t="closed"===c||"all"===c?"invoice_amount":"total_amount_due";e.setAPISort(t)}},"open"===c?"Amount Due":"all"===c?"Amount":"Invoice Amount",r.a.createElement("span",{className:"sort-icons"},r.a.createElement("i",{className:"fas fa-caret-up"}),r.a.createElement("i",{className:"fas fa-caret-down"})))},accessor:"closed"===c||"all"===c?"invoice_amount":"total_amount_due",width:100,className:"text-right pr-2",Cell:function(e){return Object(B.c)(C()(e,"value",""))}},{Header:function(){return r.a.createElement("div",{className:"cursour-pointer text-center",onClick:function(){e.setAPISort("status")}},"Status",r.a.createElement("span",{className:"sort-icons"},r.a.createElement("i",{className:"fas fa-caret-up"}),r.a.createElement("i",{className:"fas fa-caret-down"})))},accessor:"status",Cell:function(e){return r.a.createElement("div",{className:"text-center"},C()(e,"original.status","Schedule payment"))}},{Header:function(){return r.a.createElement("span",null)},accessor:"supplier.sentiment",width:100,Cell:function(t){return r.a.createElement(N.a,{dataId:C()(t,"original.supplier.id",""),sentiment:C()(t,"original.client_supplier_rel.sentiment",""),getRating:e.getRating})}}],te=b.filter((function(e){return 0!==e.id})),ae=G?{TheadComponent:function(){return r.a.createElement("div",null)}}:{};return r.a.createElement(y.a,null,r.a.createElement("div",{className:"card-body"},r.a.createElement(_.a,{header:"Update ".concat(q," Date"),show:K,handleClose:function(){return e.setState({showDateModal:!1})},handleSubmit:function(t){var a=A()(t).format("MM/DD/YYYY"),n=l.filter((function(e){return e.isselected})),c=n.map((function(e){var t;return V.c.put("/apinvoice?id=".concat(e.id),(t={},Object(v.a)(t,C()(Z,"".concat(q),""),a),Object(v.a)(t,"reco_date_override","PayIQ"===q),t))}));Promise.all(c).then((function(){Object(O.a)("Updated successfully","success"),e.setState({dateModalType:"",showDateModal:!1,rows:l.map((function(e){return Object(s.a)({},e,{recommendation:e.isselected?t:e.recommendation,reco_date_overridden:e.isselected||e.reco_date_overridden,isselected:!1})}))},(function(){localStorage.setItem("refresh_reports",!0),e.filterData()}));var a=n.map((function(e){return V.c.put("/supplier/note",{date:A()().format("MM/DD/YYYY"),note:"".concat(e.invoice_number,": Updated PayIQ"),invoice_id:e.id,supplier_id:C()(e,"supplier.id","")})}));Promise.all(a)}))}}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12",style:{textAlign:"center"}},r.a.createElement("h5",null,"PayIQ"))),r.a.createElement("div",null,r.a.createElement("div",{className:"row payablenewfiltercnt"},r.a.createElement("div",{className:"col-md-12 rank-wrapper"},r.a.createElement("div",{className:"col-md-5ths"},r.a.createElement("div",{className:"commondiv filter1",onClick:function(){return e.onChangeClassification(0)}},r.a.createElement("div",{className:"commondiv-div1"},b[0].type),r.a.createElement("div",{className:"commondiv-div2"},b[0].amount))),te.map((function(t,a){return r.a.createElement(D.a,{data:t,boxIndex:a,onDrop:function(a){return e.onDrop(a,t)},onChangeClassification:e.onChangeClassification})})))),r.a.createElement("div",{className:"row mb-4 mt-2"},r.a.createElement("div",{className:"col-md-6"},r.a.createElement("div",{className:"dropdown",style:{margin:"0px"}},r.a.createElement("span",{className:"btn dropdown-toggle btn-primary","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",onClick:function(){return e.setshowFilter(!0)}},r.a.createElement("i",{className:"fa fa-sliders","aria-hidden":"true"}),"\xa0 Filter"),r.a.createElement("form",{id:"filter-form"},o?r.a.createElement(g.a,{onClickAway:this.setshowFilter},r.a.createElement("div",{id:"outerside",className:"dropdown-menu filterdroplist p-2 width-500px ".concat(o?"show":""),"aria-labelledby":"dropdownMenuLink"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6"},r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"pagepayable"},r.a.createElement("label",{className:""},"Vendor name"),r.a.createElement(E.a,{suggestions:k()(M.map((function(e){return{id:e.supplier.id,name:e.supplier.name}})),"id"),getSelected:function(t){return e.setState({vendorSelect:t})},search:function(t){return e.debounceMethod(t,"vendor")},isLoading:w,defaultValue:j&&j.name}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Invoice number"),r.a.createElement(E.a,{suggestions:k()(M.map((function(e){return{id:e.id,name:e.invoice_number}})),"id"),getSelected:function(t){return e.setState({invoiceSelect:t})},search:function(t){return e.debounceMethod(t,"invoice")},isLoading:x,defaultValue:S&&S.name})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Payment status"),r.a.createElement("select",{className:"form-control",value:c,onChange:function(t){return e.setState({status:t.target.value})}},r.a.createElement("option",{value:"all"},"All"),r.a.createElement("option",{value:"open"},"Unpaid"),r.a.createElement("option",{value:"closed"},"Paid"))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Amount"),r.a.createElement("br",null),r.a.createElement("div",{className:"pull-left w-50 pr-2"},r.a.createElement("input",{placeholder:"min",type:"number",className:"form-control",onChange:function(t){return e.setState({amount_greater_than:t.target.value})},value:F})),r.a.createElement("div",{className:"pull-left w-50 pl-2"},r.a.createElement("input",{placeholder:"max",type:"number",className:"form-control",onChange:function(t){return e.setState({amount_less_than:t.target.value})},value:I}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"mt-4"},"PayIQ overridden"),r.a.createElement("br",null),r.a.createElement("input",{type:"checkbox",checked:W,onChange:function(t){e.setState({overridden:!e.state.overridden})}}))),r.a.createElement("div",{className:"col-md-6"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Date type"),r.a.createElement("select",{className:"form-control",value:a,onChange:function(t){return e.setState({dateType:t.target.value})}},r.a.createElement("option",{value:"due"},"Due Date"),r.a.createElement("option",{value:"recommendation"},"PayIQ"))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Due date"),r.a.createElement("div",{className:"single-date-picker",style:{fontSize:12,overflow:"hidden"}},r.a.createElement(h.a,{startDate:A()(p),endDate:A()(f),getSelectedDates:this.setDates,parentEl:"#outerside"}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Sentiment"),r.a.createElement("select",{className:"form-control",value:n,onChange:function(t){return e.setState({sentiment:t.target.value})}},r.a.createElement("option",{value:""},"All"),r.a.createElement("option",{value:"1"},"Positive"),r.a.createElement("option",{value:"2"},"Neutral"),r.a.createElement("option",{value:"3"},"Negative"))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Category"),r.a.createElement("select",{className:"form-control",value:H,onChange:function(t){return e.setState({vendor_category_id:t.target.value})}},r.a.createElement("option",{selected:!0,value:""},"Select Category"),Q.map((function(e){return r.a.createElement("option",{value:e.id,key:e.id},e.name)})))),r.a.createElement("div",{className:"setbtn"},r.a.createElement("button",{type:"button",className:"btn resetbtn btn-light",onClick:this.onReset},"Reset"),r.a.createElement("button",{type:"button",className:"btn applybtn btn-primary",onClick:function(){return e.setState({currPage:1},e.filterData)}},"Submit")))))):null))),r.a.createElement("div",{className:"col-md-6",style:{textAlign:"right"}},r.a.createElement("div",{className:"dropdown"},r.a.createElement("span",{className:"btn dropdown-toggle btn-primary",role:"button",id:"","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",onClick:function(){return e.setshowExport(!0)}},"Export"),r.a.createElement(g.a,{onClickAway:this.setshowExport},r.a.createElement("div",{className:"dropdown-menu dropdown-menu-right payexpdroplist ".concat(m&&"show"),"aria-labelledby":"dropdownMenuLink",id:""},r.a.createElement(T.CSVLink,{data:z(P,c),ref:"csv",filename:"payable_".concat(A()().format("MMMM Do YYYY-h:mm:ss-a"),".csv"),style:{display:"none"}}),r.a.createElement("span",{style:{fontSize:12,display:"block",textAlign:"right",marginRight:"10px",marginBottom:"10px",cursor:"pointer"},onClick:function(){return e.exportAllData(!0)}},"Export CSV"),r.a.createElement("span",{style:{fontSize:12,display:"block",textAlign:"right",marginRight:"10px",cursor:"pointer"},onClick:this.exportAllData},"Export Excel")))))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},G?r.a.createElement("div",{className:"floatedPayIQ pt-2 pb-2 pl-1"},r.a.createElement("span",{className:"pull-left mt-2",style:{width:54}},r.a.createElement("input",{className:"md-checkbox",style:{marginLeft:16,marginTop:1},type:"checkbox",defaultChecked:C()(l,"[0]","")&&!l.find((function(e){return!e.isselected})),onChange:function(t){return e.setState({rows:l.map((function(e){return Object(s.a)({},e,{isselected:t.target.checked})}))})}})),r.a.createElement("span",{className:"mt-2"},r.a.createElement("span",{onClick:function(){e.setState({dateModalType:"PayIQ",showDateModal:!0})},className:"multiActivityshow btn btn-primary btn-sm cursour-pointer mr-2"},r.a.createElement("i",{className:"fa fa-calendar mr-1","aria-hidden":"true"}),"PayIQ Date"),r.a.createElement("span",{onClick:function(){return e.fastForwardPayiq("week")},className:"btn btn-sm btn-primary mr-2 cursour-pointer"},r.a.createElement("i",{className:"fas fa-play mr-1"})," Week"," "),r.a.createElement("span",{onClick:function(){return e.fastForwardPayiq("month")},className:"btn btn-sm btn-primary mr-2 cursour-pointer"},r.a.createElement("i",{className:"fas fa-forward mr-1"})," Month"," "),U.a.getIsPayAdmin()&&r.a.createElement("span",{onClick:this.deletePayIq,className:"btn btn-sm btn-primary cursour-pointer ".concat(!U.a.getIsPayAdmin&&"disabled")},r.a.createElement("i",{class:"fa fa-trash-o","aria-hidden":"true",style:{fontSize:"15px"}})," Delete invoice"," "),r.a.createElement("span",{className:"total-amount-wrapper",style:{right:0}},r.a.createElement("strong",null,"Total: "),r.a.createElement("span",null,Object(B.a)(Math.round(l.filter((function(e){return e.isselected})).reduce((function(e,t){return+e+ +(t.total_amount_due||t.invoice_amount)}),0))))))):null,r.a.createElement(L.a,Object.assign({},ae,{noDataText:d?"":"No data found",minRows:l.length>20?20:l.length,loading:d,resizable:!0,showPagination:!1,getTrProps:function(t,a,n){return{onClick:function(t){return e.props.changeSelection(a.original)}}},columns:ee,data:l})))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"filterthree"},r.a.createElement("div",{className:"pull-right"},r.a.createElement("button",{className:"btn btn-primary mr-2 width-94px",disabled:1===u,onClick:this.setPrevPage},"Previous"),r.a.createElement("button",{disabled:20!==l.length,className:"btn btn-primary width-94px",onClick:this.setNextPage},"Next")))))))}}]),t}(r.a.Component),$=Object(l.b)((function(e){return{login:e.payables}}),{})(K),W=(a(503),a(577)),G=a(149),X=a(533),Z=a(620),ee=a(158),te=a(621),ae=a(512),ne=a.n(ae),ce=a(490),re=a(495),le=a(25);function oe(e,t){return"supplier"===t?[{Supplier:C()(e,"supplier.name","-"),InvoiceNo:C()(e,"invoice_number","-"),DueDate:A()(C()(e,"due_date","")).format("MM/DD/YYYY"),Recommendation:C()(e,"recommendation","-"),InvoiceDate:A()(C()(e,"invoice_date","")).format("MM/DD/YYYY"),AmountDue:Object(B.b)(C()(e,"total_amount_due",0))}]:"history"===t?C()(e,"payment_history",[]).map((function(e,t){return{Sr:t+1,PaymentDate:A()(e.payment_date).format("MM/DD/YYYY"),PaymentAmount:Object(B.b)(e.amount),Account:ne()(e.account_number),PaymentMethod:ne()(e.payment_method),PaymentReference:e.payment_reference}})):void 0}var ie=[{name:"Critical",value:1},{name:"High",value:2},{name:"Medium",value:3},{name:"Low",value:4}];var se=Object(l.b)((function(e){return{}}),{})((function(e){var t=e.history,a=e.selectedpayment,l=t.location.pathname.split("/")[2],o=Object(c.useState)(a),m=Object(n.a)(o,2),u=m[0],d=m[1],p=Object(c.useState)([]),f=Object(n.a)(p,2),b=f[0],v=f[1],E=Object(c.useState)(!1),h=Object(n.a)(E,2),y=h[0],N=h[1],_=Object(c.useState)(),D=Object(n.a)(_,2),Y=D[0],w=D[1],x=Object(c.useState)(),M=Object(n.a)(x,2),P=M[0],k=M[1],I=Object(c.useState)(A()().format("MM/DD/YYYY")),L=Object(n.a)(I,2),Q=L[0],q=L[1],z=Object(c.useState)(A()().format("MM/DD/YYYY")),J=Object(n.a)(z,2),K=J[0],$=J[1],ae=Object(c.useState)("cash"),se=Object(n.a)(ae,2),me=se[0],ue=se[1],de=Object(c.useState)("current account"),pe=Object(n.a)(de,2),fe=pe[0],be=pe[1],ve=Object(c.useState)(),Ee=Object(n.a)(ve,2),ge=Ee[0],he=Ee[1],ye=Object(c.useState)("cash"),Ne=Object(n.a)(ye,2),_e=(Ne[0],Ne[1],Object(c.useState)("current account")),De=Object(n.a)(_e,2),Ye=(De[0],De[1],Object(c.useState)()),Oe=Object(n.a)(Ye,2),je=(Oe[0],Oe[1]),Se=Object(c.useState)(!1),we=Object(n.a)(Se,2),xe=we[0],Me=we[1],Ce=Object(c.useState)(!1),Pe=Object(n.a)(Ce,2),ke=Pe[0],Fe=Pe[1],Ie=Object(c.useState)([]),Ae=Object(n.a)(Ie,2),Te=(Ae[0],Ae[1]),Le=Object(c.useState)(!1),Ue=Object(n.a)(Le,2),Be=Ue[0],Re=Ue[1],He=Object(c.useState)(!1),Ve=Object(n.a)(He,2),Qe=Ve[0],qe=Ve[1],ze=Object(c.useState)(!1),Je=Object(n.a)(ze,2),Ke=Je[0],$e=Je[1],We=Object(c.useState)([]),Ge=Object(n.a)(We,2),Xe=Ge[0],Ze=Ge[1],et=Object(c.useState)(null),tt=Object(n.a)(et,2),at=tt[0],nt=tt[1],ct=U.a.getIsAdmin();function rt(){V.a.get("/apinvoice?id=".concat(l)).then((function(e){d(C()(e,"data.result[0]",[])),v(C()(e,"data.result[0].payment_history",[])),it(C()(e,"data.result[0]",[]))})).catch((function(e){return Object(S.a)(e)}))}Object(c.useEffect)((function(){window.scrollTo(0,0)}),[]);var lt=function(){document.getElementById("details-form").reset(),w(""),he("")},ot=function(){document.getElementById("history-detail-form").reset(),k(""),je(""),$e(!1)},it=function(e){V.a.get("paymentplan?supplier_id=".concat(C()(e,"supplier.id",""))).then((function(t){var a=C()(t,"data.result",[]).find((function(e){return!e.is_payment_plan}));a=(a=a?[a]:[]).map((function(e){return Object(s.a)({},e,{installments:e.installments.map((function(e){return[e[0],A()(e[1]).format("MM/DD/YYYY"),e[2]]}))})})),nt(C()(t,"data.result",[]).find((function(e){return e.is_payment_plan}))),Ze(a);var n=[].concat(Object(i.a)(C()(e,"payment_history",[])),Object(i.a)(C()(a,"[0].installments",[]).map((function(e,t){return{amount:e[2],id:C()(a,"[0].id",""),payment_date:e[1],is_partial_payment:!0,paymentindex:t,paymentid:e[0]}}))));v(n)})).catch((function(e){return Object(S.a)(e)}))};Object(c.useEffect)((function(){V.a.get("/apinvoice?id=".concat(l)).then((function(e){d(C()(e,"data.result[0]",[])),it(C()(e,"data.result[0]",[]))})).catch((function(e){return Object(S.a)(e)})),V.a.get("supplier/note?invoice_id=".concat(l)).then((function(e){Te(C()(e,"data.result",[]))})).catch((function(e){return Object(S.a)(e)}))}),[l]);var st=b.length?Object(B.f)(b.reduce((function(e,t){return e+t.amount}),0)):"-";return r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("form",{action:"",method:"post"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"paynewdetsec",style:{marginBottom:"10px"}},r.a.createElement("div",{className:"titletranshist",style:{fontSize:"18px",paddingBottom:"15px",float:"left"}},r.a.createElement("span",{onClick:function(){return t.goBack()},title:"Back"},r.a.createElement("i",{className:"fa fa-arrow-left",style:{color:"#ddd",marginRight:"5px",ariaHidden:!0,cursor:"pointer"}})),"\xa0Invoice Details"),r.a.createElement("div",{className:"dropdown float-right"},r.a.createElement("span",{className:"btn dropdown-toggle btn-primary",href:"#",role:"button",id:"export","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",onClick:function(){return N(!0)}},"Export"),r.a.createElement(g.a,{onClickAway:N},r.a.createElement("div",{className:"dropdown-menu dropdown-menu-right payexpdroplist ".concat(y&&"show"),"aria-labelledby":"dropdownMenuLink",id:""},r.a.createElement(T.CSVLink,{data:oe(u,"history"),filename:"invoice_".concat(A()().format("MMMM Do YYYY-h:mm:ss-a"),".csv")},"Export CSV"),r.a.createElement("span",{style:{fontSize:12,float:"right",marginRight:"10px",cursor:"pointer"},onClick:function(){return function(e){var t="PayableDetails".concat(A()().format("MMMM Do YYYY-h:mm:ss-a"),".xlsx"),a={Sheets:{InvoiceDetails:H.utils.json_to_sheet(oe(e,"supplier")),PaymentHistory:H.utils.json_to_sheet(oe(e,"history"))},SheetNames:["InvoiceDetails","PaymentHistory"]},n=H.write(a,{bookType:"xlsx",type:"array"}),c=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});j.saveAs(c,t)}(u)}},"Export Excel")))),r.a.createElement("div",{className:"row",style:{clear:"both"}},r.a.createElement("div",{className:"col-md-12",style:{paddingBottom:"5px"}},r.a.createElement("label",null,"Vendor name:"),r.a.createElement(le.b,{className:"ml-2",to:"/vendors/".concat(C()(u,"supplier.id",""))},C()(u,"supplier.name","")))),r.a.createElement("div",{className:"row mb-3"},r.a.createElement("div",{className:"col-md-2"},r.a.createElement("label",null,"Invoice number :")," ",r.a.createElement("div",null,C()(u,"invoice_number",""))),r.a.createElement("div",{className:"col-md-2"},r.a.createElement("label",null,"Invoice amount :")," ",r.a.createElement("div",null,Object(B.c)(C()(u,"invoice_amount","")))),r.a.createElement("div",{className:"col-md-2"},r.a.createElement("label",null,"Amount due :")," ",r.a.createElement("div",null,Object(B.c)(C()(u,"total_amount_due","")))),r.a.createElement("div",{className:"col-md-2"},r.a.createElement("label",null,"Amount paid :")," ",r.a.createElement("div",null,st)),r.a.createElement("div",{className:"col-md-2"},r.a.createElement("label",null,"Invoice date :")," ",r.a.createElement("div",null,Object(R.b)(C()(u,"invoice_date","")))),r.a.createElement("div",{className:"col-md-2"},r.a.createElement("label",null,"Due Date :")," ",r.a.createElement("div",null,Object(R.b)(C()(u,"due_date",""))))))),r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"paynewdetsec"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-2"},r.a.createElement("label",null,"PayIQ date :"),r.a.createElement("div",null,r.a.createElement(X.a,{value:C()(u,"recommendation",""),min:A()().format("YYYY-MM-DD"),updateValue:function(e){V.a.put("/apinvoice?id=".concat(l),{recommendation_date:e?A()(e).format("MM/DD/YYYY"):null,reco_date_override:!0}).then((function(){return localStorage.setItem("refresh_reports",!0)}))}}))),r.a.createElement("div",{className:"col-md-2"},r.a.createElement("label",null,"PO number: ")," ",r.a.createElement("div",null,"-")),r.a.createElement("div",{className:"col-md-2"},r.a.createElement("label",null,"Vendor account number: ")," ",r.a.createElement("div",null,"-")),r.a.createElement("div",{className:"col-md-2"},r.a.createElement("label",null,"Payment type requested: ")," ",r.a.createElement("div",null,"-")),r.a.createElement("div",{className:"col-md-2"},r.a.createElement("label",null,"Tax number: ")," ",r.a.createElement("div",null,"-")),r.a.createElement("div",{className:"col-md-2"},r.a.createElement("label",null,"Classification: ")," ",r.a.createElement("div",null,r.a.createElement(ee.a,{value:C()(u,"classification",""),options:ie,updateValue:function(e){V.a.put("".concat("apinvoice","?id=").concat(l),{classification:e}).then((function(){Object(O.a)("Updated successfully","success")})).catch((function(e){return Object(S.a)(e)}))}}))),r.a.createElement("div",{className:"col-md-2"},r.a.createElement("label",null,"Payment Plan: ")," ",r.a.createElement("div",null,C()(u,"payment_plan_id","")?C()(at,"id","")?r.a.createElement(le.b,{to:"/vendors/".concat(C()(u,"supplier.id",""))},C()(u,"payment_plan_id","")):C()(u,"payment_plan_id",""):"-"))))),r.a.createElement("div",{className:"divider"}),r.a.createElement(ce.a,{className:"col-md-12"},r.a.createElement(ce.a.Toggle,{className:"border mt-4 px-3 cursour-pointer bg-light-grey",as:re.a.Header,eventKey:"0"},r.a.createElement("h6",{className:"my-0"},"Payments")),r.a.createElement(ce.a.Collapse,{className:"p-2 px-3",eventKey:"0"},r.a.createElement("div",{className:"paynewdetsec"},r.a.createElement("span",{onClick:function(){return Re(!0)},className:"multiActivityshow btn btn-primary btn-sm mt-2 cursour-pointer ".concat(C()(u,"payment_plan_id","")?"d-none":"")},r.a.createElement("i",{className:"far fa-calendar-plus mr-1"})," Payment Plan"," "),r.a.createElement("form",{id:"details-form",className:"mt-3"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-4"},r.a.createElement("div",{className:"form-group"},r.a.createElement("span",null,r.a.createElement("label",null,"Payment Amount")),r.a.createElement("input",{type:"number",onInput:function(e){Me(Number(e.target.value)>Number(C()(u,"total_amount_due",""))),w(e.target.value)},className:"form-control ".concat(xe?"error":""),maxLength:"20",placeholder:"Enter amount",id:"amount",value:Y}),xe?r.a.createElement("span",{className:"error"},"Payment amount should not exceed amount due."):"")),r.a.createElement("div",{className:"col-md-4"},r.a.createElement("div",{className:"form-group single-date-picker"},r.a.createElement("span",null,r.a.createElement("label",null,"Payment Date2")),r.a.createElement(G.a,{labelFormat:"MMM DD, YYYY",startDate:A()(Q,"MM/DD/YYYY"),getSelectedDates:function(e){q(e.format("MM/DD/YYYY"))}}))),r.a.createElement("div",{className:"col-md-4"},r.a.createElement("div",{className:"form-group"},r.a.createElement("span",null,r.a.createElement("label",null,"Payment Method")),r.a.createElement("select",{className:"form-control",onChange:function(e){return ue(e.target.value)}},r.a.createElement("option",{value:"cash"},"Cash"),r.a.createElement("option",{value:"check"},"Check"),r.a.createElement("option",{value:"credit card"},"Credit Card")))),r.a.createElement("div",{className:"col-md-4"},r.a.createElement("div",{className:"form-group"},r.a.createElement("span",null,r.a.createElement("label",null,"Account")),r.a.createElement("select",{className:"form-control",onChange:function(e){return be(e.target.value)}},r.a.createElement("option",{value:"current account"},"Current Account"),r.a.createElement("option",{value:"saving account"},"Saving Account"),r.a.createElement("option",{value:"recurring deposit account"},"Recurring Deposit Account"),r.a.createElement("option",{value:"fixed deposit account"},"Fixed Deposit Account")))),r.a.createElement("div",{className:"col-md-4"},r.a.createElement("div",{className:"form-group"},r.a.createElement("span",null,r.a.createElement("label",null,"Payment Reference")),r.a.createElement("input",{type:"text",onChange:function(e){return he(e.target.value)},className:"form-control",placeholder:"Enter ..."}))),r.a.createElement("div",{className:"col-md-4"},r.a.createElement("div",{className:"form-group text-right",style:{marginTop:"30px"}},r.a.createElement("button",{type:"button",className:"btn subbtn btn-light m-1",style:{border:"1px solid #ddd"},onClick:lt},"Reset"),r.a.createElement("button",{type:"button",className:"btn subbtn btn-primary",disabled:!0,onClick:function(){var e={amount:Y,date:Q,method:me,account:fe,reference:ge};V.a.put("/apinvoice/payment?id=".concat(l),e).then((function(){Object(O.a)("Updated successfully","success"),lt(),rt()})).catch((function(e){return Object(S.a)(e)}))}},"Submit")))))))),r.a.createElement(ce.a,{className:"col-md-12"},r.a.createElement(ce.a.Toggle,{className:"border mt-4 px-3 cursour-pointer bg-light-grey",as:re.a.Header,eventKey:"1",onClick:function(){return qe(!Qe)}},r.a.createElement("h6",{className:"my-0"},"Payment History & Partial Payments",!Ke&&Qe&&ct&&r.a.createElement("i",{onClick:function(e){e.stopPropagation(),$e(!0)},className:"fa fa-plus cashinflowclick t-10 ".concat(""),title:"click to add/invite user","aria-hidden":"true"}))),r.a.createElement(ce.a.Collapse,{className:"py-2",eventKey:"1"},r.a.createElement("form",{action:!0,method:"post",id:"history-detail-form"},r.a.createElement("div",{className:"px-0"},Ke&&r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-4"},r.a.createElement("div",{className:"form-group"},r.a.createElement("span",null,r.a.createElement("label",null,"Payment Amount")),r.a.createElement("input",{type:"number",onInput:function(e){Fe(Number(e.target.value)>Number(C()(u,"total_amount_due",""))),k(e.target.value)},className:"form-control ".concat(ke?"error":""),maxLength:"20",placeholder:"Enter amount",id:"amount",value:P}))),r.a.createElement("div",{className:"col-md-4"},r.a.createElement("div",{className:"form-group single-date-picker"},r.a.createElement("span",null,r.a.createElement("label",null,"Payment Date")),r.a.createElement(G.a,{labelFormat:"MMM DD, YYYY",getSelectedDates:function(e){return $(e.format("MM/DD/YYYY"))}}))),r.a.createElement("div",{className:"col-md-4"},r.a.createElement("div",{className:"form-group text-right",style:{marginTop:"30px"}},r.a.createElement("button",{type:"button",className:"btn subbtn btn-light m-1",style:{border:"1px solid #ddd"},onClick:ot},"Cancel"),r.a.createElement("button",{type:"button",onClick:function(){if(C()(Xe,"[0]",""))!function(){var e={installments:{add:[{date:K,amount:P}],edit:C()(Xe,"[0].installments",[]).map((function(e){return{id:e[0],amount:Number(e[2]).toFixed(2),date:A()(e[1]).format("MM/DD/YYYY")}})),delete:[]},invoices:{add:[],delete:[]},is_payment_plan:!1};V.a.patch("paymentplan?id=".concat(C()(Xe,"[0].id","")),Object(s.a)({},e)).then((function(e){Object(O.a)("Updated successfully","success"),ot(),rt(),localStorage.setItem("refresh_reports",!0)}))}();else{var e={supplier_id:C()(u,"supplier.id",""),invoices:[l],installments:[{date:K,amount:P}],is_payment_plan:!1};V.a.post("/paymentplan",e).then((function(){Object(O.a)("Updated successfully","success"),ot(),rt(),localStorage.setItem("refresh_reports",!0)})).catch((function(e){return Object(S.a)(e)}))}},className:"btn subbtn btn-primary",disabled:!P},"Submit"))))))),r.a.createElement(ce.a.Collapse,{className:"py-2",eventKey:"1"},r.a.createElement("div",{className:"paynewdetsectran"},r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Sr No."),r.a.createElement("th",null,"Payment Amount"),r.a.createElement("th",null,"Payment Date"),r.a.createElement("th",null,"Payment Method"),r.a.createElement("th",null,"Account"),r.a.createElement("th",null,"Payment Reference"),r.a.createElement("th",null,"Action")),(console.log("paymentHistory",b),b.map((function(e,t){return r.a.createElement("tr",null,r.a.createElement("td",null,t+1),r.a.createElement("td",null,te.a.CURRENCY[e.currency||"USD"].symbol,e.amount),r.a.createElement("td",null,A()(e.payment_date).format("MM/DD/YYYY")),r.a.createElement("td",null,ne()(e.payment_method)),r.a.createElement("td",null,ne()(e.account_number)),r.a.createElement("td",null,e.payment_reference),r.a.createElement("td",{className:"text-sm-center"},r.a.createElement("span",{className:"btn",onClick:function(t){t.stopPropagation(),Object(F.c)({variant:"warning",msg:"Are you sure you want to delete this category?",onSave:function(){var t;Object(F.b)(),e.is_partial_payment?function(e,t){var a={installments:{add:[],edit:C()(Xe,"[0].installments",[]).filter((function(e,a){return a!=t})).map((function(e){return{id:e[0],amount:Number(e[2]).toFixed(2),date:A()(e[1]).format("MM/DD/YYYY")}})),delete:[e]},invoices:{add:[],delete:[]},is_payment_plan:!1};V.a.patch("paymentplan?id=".concat(C()(Xe,"[0].id","")),Object(s.a)({},a)).then((function(e){Object(O.a)("Updated successfully","success"),ot(),rt(),localStorage.setItem("refresh_reports",!0)}))}(C()(e,"paymentid",""),e.paymentindex):(t=e.id,V.a.put("apinvoice/payment/delete?payment_id=".concat(t)).then((function(){Object(O.a)("Deleted successfully","success"),rt(),localStorage.setItem("refresh_reports",!0)})).catch((function(e){return Object(S.a)(e)})))}})}},r.a.createElement("i",{className:"fa fa-trash-o cursor-pointer color-blue"}))))})))))))),r.a.createElement("div",{className:"w-100"},r.a.createElement(Z.a,{type:"payables",id:l,data:u})),r.a.createElement(W.a,{invoices:u?[u]:[],show:Be,onHide:Re,getPaymentPlan:rt}))))))}));t.default=Object(o.g)(Object(l.b)((function(e){return{login:e.payables}}),{})((function(e){document.title="Payables - Payference";var t=e.history,a=e.match,l=Object(c.useState)(null),i=Object(n.a)(l,2),s=i[0],m=i[1];function u(e){m(e),t.push("payables/".concat(e.id))}return r.a.createElement("div",null,r.a.createElement("div",{className:"row px-15",id:"dashboardBody"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"card"},r.a.createElement(o.d,null,r.a.createElement(o.b,{path:"".concat(a.path,"/:paymentid"),component:function(){return r.a.createElement(se,Object.assign({},e,{selectedpayment:s}))}}),r.a.createElement(o.b,{path:"".concat(a.path),component:function(){return r.a.createElement($,Object.assign({},e,{changeSelection:u}))}}))))))})))}}]);
//# sourceMappingURL=18.0ec27fb3.chunk.js.map